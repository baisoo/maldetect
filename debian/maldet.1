.\" DO NOT MODIFY THIS FILE!  It was generated by help2man 1.38.2.
.TH LINUX-MALWARE-DETECT "1" "October 2013" "Linux Malware Detect v1.4.2" "User Commands"
.SH NAME
maldet \- Linux Malware Detect
.SH SYNOPSIS
.PP
maldet [\-h|\-\-help] [\-l|\-\-log] [\-e|\-\-report] [\-p|\-\-purge] [\-c|\-\-checkout]
[\-b|\-\-background] [\-m|\-\-monitor] [\-k|\-\-kill\-monitor] [\-a|\-\-scan\-all] [\-r|\-\-scan\-recent]
[\-q|\-\-quarantine] [\-s|\-\-restore] [\-n|\-\-clean] [\-u|\-\-update]
.SH DESCRIPTION
Linux Malware Detect is a malware scanner for Linux released under the GNU GPLv2 license, that is designed around the threats faced in shared hosted environments. It uses threat data from network edge intrusion detection systems to extract malware that is actively being used in attacks and generates signatures for detection. In addition, threat data is also derived from user submissions with the LMD checkout feature and from malware community resources. The signatures that LMD uses are MD5 file hashes and HEX pattern matches, they are also easily exported to any number of detection tools such as ClamAV.
.PP
The driving force behind LMD is that there is currently limited availability of open source/restriction free tools for Linux systems that focus on malware detection and more important that get it right. Many of the AV products that perform malware detection on Linux have a very poor track record of detecting threats, especially those targeted at shared hosted environments.
.PP
The threat landscape in shared hosted environments is unique from that of the standard AV products detection suite in that they are detecting primarily OS level trojans, rootkits and traditional file-infecting viruses but missing the ever increasing variety of malware on the user account level which serves as an attack platform.
.HP
The command line options are as follows:
.HP
\fB\-b\fR, \fB\-\-background\fR
.IP
Execute operations in the background, ideal for large scans
e.g: maldet \fB\-b\fR \fB\-r\fR /home/?/public_html 7
.HP
\fB\-u\fR, \fB\-\-update\fR
.IP
Update malware detection signatures from rfxn.com
.HP
\fB\-m\fR, \fB\-\-monitor\fR USERS|PATHS|FILE
.IP
Run maldet with inotify kernel level file create/modify monitoring
If USERS is specified, monitor user homedirs for UID's > 500
If FILE is specified, paths will be extracted from file, line spaced
If PATHS are specified, must be comma spaced list, NO WILDCARDS!
e.g: maldet \fB\-\-monitor\fR users
e.g: maldet \fB\-\-monitor\fR /root/monitor_paths
e.g: maldet \fB\-\-monitor\fR /home/mike,/home/ashton
.HP
\fB\-k\fR, \fB\-\-kill\fR
.IP
Terminate inotify monitoring service
.HP
\fB\-r\fR, \fB\-\-scan\-recent\fR PATH DAYS
.IP
Scan files created/modified in the last X days (default: 7d, wildcard: ?)
e.g: maldet \fB\-r\fR /home/?/public_html 2
.HP
\fB\-a\fR, \fB\-\-scan\-all\fR PATH
.IP
Scan all files in path (default: /home, wildcard: ?)
e.g: maldet \fB\-a\fR /home/?/public_html
.HP
\fB\-c\fR, \fB\-\-checkout\fR FILE
.IP
Upload suspected malware to rfxn.com for review & hashing into signatures
.HP
\fB\-l\fR, \fB\-\-log\fR
.IP
View maldet log file events
.HP
\fB\-e\fR, \fB\-\-report\fR SCANID email
.IP
View scan report of most recent scan or of a specific SCANID and optionally
e\-mail the report to a supplied e\-mail address
e.g: maldet \fB\-\-report\fR
e.g: maldet \fB\-\-report\fR list
e.g: maldet \fB\-\-report\fR 050910\-1534.21135
e.g: maldet \fB\-\-report\fR SCANID user@domain.com
.HP
\fB\-s\fR, \fB\-\-restore\fR FILE|SCANID
.IP
Restore file from quarantine queue to orginal path or restore all items from
a specific SCANID
e.g: maldet \fB\-\-restore\fR /usr/local/maldetect/quarantine/config.php.23754
e.g: maldet \fB\-\-restore\fR 050910\-1534.21135
.HP
\fB\-q\fR, \fB\-\-quarantine\fR SCANID
.IP
Quarantine all malware from report SCANID
e.g: maldet \fB\-\-quarantine\fR 050910\-1534.21135
.HP
\fB\-n\fR, \fB\-\-clean\fR SCANID
.IP
Try to clean & restore malware hits from report SCANID
e.g: maldet \fB\-\-clean\fR 050910\-1534.21135
.HP
\fB\-U\fR, \fB\-\-user\fR USER
.IP
Set execution under specified user, ideal for restoring from user quarantine or
to view user reports.
e.g: maldet \fB\-\-user\fR nobody \fB\-\-report\fR
e.g: maldet \fB\-\-user\fR nobody \fB\-\-restore\fR 050910\-1534.21135
.HP
\fB\-co\fR, \fB\-\-config\-option\fR VAR1=VALUE,VAR2=VALUE,VAR3=VALUE
.IP
Set or redefine the value of conf.maldet config options
e.g: maldet \fB\-\-config\-option\fR email_addr=you@domain.com,quar_hits=1
.HP
\fB\-p\fR, \fB\-\-purge\fR
.IP
Clear logs, quarantine queue, session and temporary data.
.SH LICENSE
This program may be freely redistributed under the terms of the GNU GPL v2
.SH AUTHORS
.PP
(C) 2002\-2013, R\-fx Networks <proj@r\-fx.org>
(C) 2013, Ryan MacDonald <ryan@r\-fx.org>

